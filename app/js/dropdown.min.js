
var Dropdown=(function(){'use strict';var document=window.document;function Dropdown(selector,settings){if(typeof selector==='object'&&selector.dropdown){return selector;}
if(typeof selector!=='string'){return selector;}
return new Dropdown.fn.init(selector,settings);}
function merge(object,extra){var copy,attribute;if(object===null||typeof object!=="object"){return object;}
copy=object.constructor();for(attribute in object){if(object.hasOwnProperty(attribute)){copy[attribute]=object[attribute];if(extra.hasOwnProperty(attribute)){copy[attribute]=extra[attribute];}}}
return copy;}
function hasClass(element,className){if(element.classList){return element.classList.contains(className);}
return new RegExp('(^| )'+className+'( |$)','gi').test(element.className);}
function removeClass(element,className){if(element.classList){element.classList.remove(className);}else if(hasClass(element,className)){var reg=new RegExp('(\\s|^)'+className+'(\\s|$)');element.className=element.className.replace(reg,' ');}}
function addClass(element,className){if(element.classList){element.classList.add(className);}else if(!hasClass(element,className)){element.className+=" "+className;}}
function clickContainer(event){var rect=this.getBoundingClientRect();event.stopPropagation();addClass(this,'dropdown-open');if(document.body.offsetHeight<this.children[1].offsetHeight+rect.top+window.scrollY){addClass(this,'dropdown-upsidedown');}}
function clickView(event){event.preventDefault();}
function clickOutside(event){event.stopPropagation();removeClass(this.parentNode,'dropdown-open');}
function clickOptionContainer(event){event.stopPropagation();}
function clickMultiClose(event){var span=this.parentNode,view=span.parentNode,selected=span.getAttribute('data-selected'),option,select=view.parentNode.previousElementSibling;span.remove();option=view.parentNode.querySelector('li[data-index="'+selected+'"]');removeClass(option,'selected');select.options[selected].selected=false;if(view.children.length<=1){view.children[0].style.display='';}
event.stopPropagation();event.preventDefault();}
function clickOption(){var span=document.createElement('span'),selected=this.getAttribute('data-index'),dropdown=this.parentNode,view,multiIcon,multiPlaceholder,select=null,options=null,i=0;do{dropdown=dropdown.parentNode;}while(dropdown.tagName!=='DIV');view=dropdown.querySelector('.dropdown-view');span.setAttribute('data-selected',selected);span.innerHTML=this.innerHTML;if(hasClass(dropdown,'dropdown-multiple')){multiIcon=document.createElement('a');multiIcon.className='icon icon-cross';multiIcon.setAttribute('href','#');multiIcon.onclick=clickMultiClose;span.appendChild(multiIcon);multiPlaceholder=view.querySelector('.placeholder');if(multiPlaceholder){multiPlaceholder.style.display='none';}}else{view.innerHTML='';}
view.appendChild(span);select=dropdown.previousSibling;select.options[selected].selected=true;options=dropdown.querySelectorAll('li.selected');if(!hasClass(dropdown,'dropdown-multiple')){for(i=0;i<options.length;i=i+1){removeClass(options[i],'selected');}}
addClass(this,'selected');removeClass(dropdown,'dropdown-open');}
function addEvent(element,event,handler){if(element.attachEvent){return element.attachEvent('on'+event,handler);}
return element.addEventListener(event,handler,false);}
function addClickListeners(dropdown){addEvent(dropdown,'click',clickContainer);addEvent(dropdown.querySelector('.dropdown-view'),'click',clickView);addEvent(dropdown.querySelector('.dropdown-options'),'click',clickOptionContainer);addEvent(dropdown.querySelector('.dropdown-outside'),'click',clickOutside);}
function buildHTML(){var container=document.createElement('div'),view=document.createElement('a'),options=document.createElement('ul'),outside=document.createElement('div');container.className='dropdown-container';view.className='dropdown-view';view.href='#';view.setAttribute('tab-index','-1');options.className='dropdown-options';outside.className='dropdown-outside';container.appendChild(view);container.appendChild(options);container.appendChild(outside);return container;}
function buildOptionHTML(element,index,isSelected,isDisabled){var option=document.createElement('li'),list,i;if(element.tagName==='OPTGROUP'){option.innerHTML=element.getAttribute('label')||'Group';option.className='optgroup';list=document.createElement('ul');for(i=0;i<element.children.length;i=i+1){list.appendChild(buildOptionHTML(element.children[i],index,isSelected,isDisabled));}
option.appendChild(list);return option;}
option.innerHTML=element.innerHTML;if(element.className){option.className=element.className;}
option.setAttribute('data-index',index.num);index.num=index.num+1;option.onclick=clickOption;option.setAttribute('value',element.getAttribute('value'));if(option.className===''){option.className='option';}else{option.className+=' option';}
if(isSelected){option.className+=' selected';}
if(isDisabled){option.className+=' disabled';}
return option;}
Dropdown.fn=Dropdown.prototype={dropdown:true,selector:'.dropdown',length:0,settings:{width:200,maxHeight:200,ellipsis:true,hideSelected:false,placeholder:null,multi:false,multiText:'Choose some options'},events:{open:[],close:[],option:[]},init:function(sel,opts){var elements=null,element,i=0;if(!sel){return this;}
if(typeof sel!=='string'){throw'Error: Dropdown constructor paramenter is not a valid string';}
this.selector=sel;this.length=0;this.opts=opts;this.settings=merge(this.settings,opts);this.events=merge(this.events,{});elements=document.querySelectorAll(sel);for(i=0;i<elements.length;i=i+1){element=elements[i];if(element.tagName==='SELECT'){this[this.length]=element;this.length=this.length+1;}}
return this;},apply:function(){var template=buildHTML(),i,j,select,selectParent,dropdown,option,isSelected,isDisabled,span,index={num:0};for(i=0;i<this.length;i=i+1){select=this[i];dropdown=template.cloneNode(true);addClickListeners(dropdown);for(j=0;j<select.attributes.length;j=j+1){if(select.attributes[j].nodeName!=='class'){dropdown.setAttribute(select.attributes[j].nodeName,select.attributes[j].nodeValue);}else{dropdown.className=select.attributes[j].nodeValue+' '+dropdown.className;}}
if(select.hasAttribute('multiple')){this.settings.multi=true;}
span=document.createElement('span');if(this.settings.placeholder){span.innerHTML=this.settings.placeholder;span.setAttribute('data-selected',-1);select.selectedIndex=-1;}else if(select.hasAttribute('data-placeholder')){span.innerHTML=select.getAttribute('data-placeholder');span.setAttribute('data-selected',-1);select.selectedIndex=-1;}else if(!this.settings.multi){span.innerHTML=select[select.selectedIndex].innerHTML;span.setAttribute('data-selected',select.selectedIndex);}else{span.innerHTML=this.settings.multiText;addClass(span,'placeholder');select.selectedIndex=-1;}
dropdown.children[0].appendChild(span);index.num=0;for(j=0;j<select.children.length;j=j+1){isSelected=select.selectedIndex===j?true:false;isDisabled=select[j].hasAttribute('disabled');option=buildOptionHTML(select.children[j],index,isSelected,isDisabled);dropdown.querySelector('ul').appendChild(option);}
if(this.settings.ellipsis){addClass(dropdown,'dropdown-ellipsis');}
if(this.settings.hideSelected){addClass(dropdown,'dropdown-hideSelected');}
if(this.settings.multi){addClass(dropdown,'dropdown-multiple');}
dropdown.style.width=this.settings.width+'px';dropdown.querySelector('.dropdown-options').style.maxHeight=this.settings.maxHeight+'px';selectParent=select.parentNode;if(selectParent.lastchild===select){selectParent.appendChild(dropdown);}else{selectParent.insertBefore(dropdown,select.nextSibling);}
select.style.display='none';dropdown=null;}
return this;},placeholder:function(placeholderText){if(typeof placeholderText==='string'){this.settings.placeholder=placeholderText;}
return this;},on:function(type,handler){if(typeof handler!=='function'){return this;}
if(type==='open'){this.events.open.push(handler);}else if(type==='close'){this.events.close.push(handler);}
return this;}};Dropdown.fn.init.prototype=Dropdown.fn;return Dropdown;}());